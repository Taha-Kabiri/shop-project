<div class="lobby-wrapper">
  <% if (typeof products !== 'undefined' && products.length > 0) { %>
  <div id="product-slider">
    <% products.forEach((product, index) => { %>
    <div
      class="product-slide <%= index === 0 ? 'active' : '' %>"
      data-index="<%= index %>"
    >
      <div class="info-side">
        <div class="glass-info-card">
          <div class="brand-tag">
            <span class="brand-text"
              >T-KALA | <%= product.brand || 'Premium' %></span
            >
            <div class="connecting-line"></div>
          </div>

          <h1 class="title-glow"><%= product.title %></h1>

          <div class="specs">
            <p>● کیفیت تضمینی و متریال درجه یک</p>
            <p>● طراحی مدرن و منحصر‌به‌فرد</p>
            <p>● ضمانت اصالت کالا</p>
          </div>

          <div class="price-section">
            <span class="amount"
              ><%= product.price ? product.price.toLocaleString() : '۰' %></span
            >
            <span class="currency">تومان</span>
          </div>

          <a href="/cart/add/<%= product._id %>" class="action-btn"
            >خرید سریع</a
          >
        </div>
      </div>

      <div class="image-side">
        <div class="main-image-container">
          <img
            src="<%= product.imageUrl %>"
            alt="<%= product.title %>"
            class="floating-img"
          />
          <div class="glow-sphere"></div>
        </div>
      </div>
    </div>
    <% }) %>
  </div>
  <% } else { %>
  <div style="color: #eee3cb; text-align: center; padding-top: 20vh">
    <h2>محصولی برای نمایش یافت نشد.</h2>
  </div>
  <% } %>
</div>

<style>
  .lobby-wrapper {
    background: radial-gradient(circle at center, #b7c4cf 0%, #967e76 100%);
    height: 100vh;
    width: 100%;
    overflow: hidden;
    font-family: "Tahoma", sans-serif;
    direction: rtl;
  }

  .product-slide {
    display: none;
    grid-template-columns: 1.2fr 1fr;
    height: 100vh;
    align-items: center;
    padding: 0 10%;
  }

  .product-slide.active {
    display: grid;
  }

  .info-side {
    position: relative;
    z-index: 10;
    text-align: right;
  }

  .glass-info-card {
    padding: 40px;
    background: rgba(150, 126, 118, 0.25);
    backdrop-filter: blur(15px);
    border-radius: 30px;
    border: 1px solid rgba(238, 227, 203, 0.3);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
  }

  .brand-text {
    color: #eee3cb;
    font-weight: bold;
    font-size: 1.1rem;
    letter-spacing: 1px;
  }

  .connecting-line {
    height: 2px;
    background: #d7c0ae;
    margin-top: 5px;
    width: 50px;
  }

  .title-glow {
    font-size: 3.5rem;
    color: #ffffff;
    text-shadow: 0 0 20px rgba(238, 227, 203, 0.5);
    margin: 15px 0;
  }

  .specs {
    margin: 20px 0;
  }

  .specs p {
    color: #eee3cb;
    font-size: 1.1rem;
    margin: 8px 0;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
  }

  .price-section {
    margin: 25px 0;
    font-size: 2.2rem;
    color: #eee3cb;
    font-weight: bold;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }

  .currency {
    color: #d7c0ae;
    font-size: 1rem;
  }

  .image-side {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  .floating-img {
    max-width: 100%;
    max-height: 450px;
    filter: drop-shadow(0 0 30px rgba(150, 126, 118, 0.5));
    border-radius: 40px;
    object-fit: cover;
    animation: float 8s ease-in-out infinite;
    z-index: 5;
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-12px);
    }
  }

  .glow-sphere {
    position: absolute;
    width: 350px;
    height: 350px;
    background: #eee3cb;
    filter: blur(150px);
    opacity: 0.25;
    border-radius: 50%;
  }

  .action-btn {
    display: inline-block;
    padding: 15px 50px;
    background: linear-gradient(45deg, #967e76, #d7c0ae);
    color: white;
    text-decoration: none;
    border-radius: 50px;
    font-weight: bold;
    transition: 0.4s;
    box-shadow: 0 10px 20px rgba(150, 126, 118, 0.4);
  }

  .action-btn:hover {
    transform: scale(1.05);
    background: linear-gradient(45deg, #d7c0ae, #967e76);
    box-shadow: 0 15px 30px rgba(150, 126, 118, 0.6);
  }

  @media (max-width: 768px) {
    .product-slide {
      grid-template-columns: 1fr;
      text-align: center;
      padding: 20px;
    }
    .info-side {
      text-align: center;
      margin-bottom: 30px;
    }
    .glass-info-card {
      padding: 25px;
    }
    .connecting-line {
      margin: 5px auto;
    }
    .title-glow {
      font-size: 2.5rem;
    }
  }
</style>

<script>
  let slideIndex = 0;
  const slides = document.querySelectorAll(".product-slide");

  function showSlides() {
    if (slides.length === 0) return;

    slides.forEach((slide) => {
      slide.classList.remove("active");
      slide.style.display = "none";
    });

    slideIndex++;
    if (slideIndex > slides.length) {
      slideIndex = 1;
    }

    slides[slideIndex - 1].style.display = "grid";
    slides[slideIndex - 1].classList.add("active");

    setTimeout(showSlides, 7000);
  }

  if (slides.length > 0) {
    showSlides();
  }
</script>
